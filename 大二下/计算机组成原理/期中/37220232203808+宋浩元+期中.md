# 37220232203808+宋浩元+期中

## 一、填空题

1. 电子管；晶体管；半导体；微处理器
2. 半导体器件；栅极；摩尔
3. 存储程序；程序控制；存储器；控制器
4. 逻辑电路；微代码；指令集架构；汇编
5. 检错；纠错；冗余；码距；4；2；1；2；唯一
6. 串行；先行；生成；传递
7. 数据量；周期；位宽
8. 易失；P 沟道 MOS；双稳态；行选；列选
9. 电容；行选通；列选通；放大；读写；灵敏放大
10. 二极管；熔丝；一；浮栅；紫外线；单个；闪存
11. 多字存储器； 低位交叉；流水线
12. 调入；一致性；写回；LRU
13. MMU；快表；全相联；页表项

## 二、问答题

### 1.写出定点运算中判断溢出的三种常用方法及其公式 。

1. 单符号位法（符号比较法）

- 方法：在加法运算中，若两个同符号数相加，结果符号与原操作数符号相反，则发生溢出。对于减法，可转化为加法后同样适用此规则。 
- 公式：  设操作数 \( A \) 的符号位为 \( S_A \)，操作数 \( B \) 的符号位为 \( S_B \)，结果符号位为 \( S_F \)，则溢出条件为：  同符号相加，结果符号相反：  
    \[
    \text{溢出} = (S_A \oplus S_B = 0) \ \text{且} \ (S_A \oplus S_F = 1)
    \]

2. 双符号位法（变形补码法）

 -   方法：采用两位符号位（正数为 `00`，负数为 `11`），若运算结果的两位符号位不同（`01` 或 `10`），则表示溢出。  
 -   公式：  设结果的双符号位为 \( S_1 S_2 \)（\( S_1 \) 为高位符号位，\( S_2 \) 为低位符号位），则溢出条件为：  
    \[
    \text{溢出} = S_1 \oplus S_2 = 1
    \]

    - `01`：正溢出
    - `10`：负溢出

3. 进位判断法（最高位进位与符号位进位异或

 -   公式：  
    设 \( C_1 \) 为符号位产生的进位（从符号位向更高位的进位，补码运算中通常忽略），\( C_2 \) 为最高数值位向符号位的进位，则溢出条件为：  
    \[
    \text{溢出} = C_1 \oplus C_2 = 1
    \]  
-    方法：若两正数相加，\(C_2 = 1\)（数值位进位到符号位），而符号位本身为  0，故  \(C_1 = 0\)，此时  \(C_1 \oplus C_2 = 1\)，溢出。若两负数相加，符号位为  1，若  \(C_2 = 0\)（数值位无进位），则符号位相加结果为  1+1+0=10，\(C_1 = 1\)，此时  \(C_1 \oplus C_2 = 1\)，溢出。

### 2.设主存容量为 1MB cache容量为 16KB 均 按字节编址 。 cache块长为 4个字，每字 32位。 
请问：
（1） 直接相联映射方式时，主存地址为 ABCDEH 的存储单元在 cache中的什么位置 ?
（2） 4路组相联映射 方式时， 主存地址为 ABCDEH 的存储单元在 cache中的什么位置 ?


基础计算：
- 主存容量 \(=1\) MiB \(=2^{20}\) 字节  
- Cache 容量 \(=16\) KiB \(=2^{14}\) 字节  
- 块大小 \(=4\) 字 × 4 字节/字 = 16 字节  
- Cache 块数 \(=\dfrac{2^{14}}{16}=2^{10}=1024\)  

地址\(ABCDE\) 的二进制展开：  
\[
A=1010,\;B=1011,\;C=1100,\;D=1101,\;E=1110.
\]  

---

(1) 直接相联映射  
- 块内偏移 ＝低 4 位 =\(E\)  
- 行号 ＝地址高 \(20-4\) 位右移 4 位后取低 10 位  
- Tag ＝块号 \(\bigl(ABCD\div 400\bigr)\)＝\(2A\).  

结果：  即该字节存放在 Cache 第 0x3CD 行，块内偏移 0xE。

---

(2) 4 路组相联映射  
- 总路数 = 1024／4 = 256 组 ⇒ \(k=\log_2 256=8\)  
- 偏移位数仍为 4，Tag 位数 \(=20-(8+4)=8\)。  


- 偏移 = 低 4 位 =\(E\)  
- 组号 = 下一 8 位  
  = 1100 1101 = CD 
- Tag = 最高 8 位（\(b_{19\sim12}\)）  
  = 从 \(A=1010\), \(B=1011\) 取 ⇒ 1010 1011 = AB

结果： 在4路组相联中，该块映射到集合号 0xCD，可存放于该集合内任一路，块内偏移 0xE。

### 3.图 1为原码一位乘的逻辑实现框图，请根据此框图回答下述问题：

（1）  手工操作中位积左移是为了对齐高位，而在计算机中，部分积右移可简化硬件实现。右移操作便于在寄存器中直接实现，每一步只需关注乘数最低位，简化了电路设计与运算流程，且能保持部分积与乘数的相对位置关系，使乘法逻辑更规整。  

（2）原码一位乘中，根据乘数最低位 \( y_n \) 决定操作：若 \( y_n = 1 \)，部分积需加被乘数 \( |x| \)；若 \( y_n = 0 \)，部分积加 \( 0 \)。MUX 根据 \( y_n \) 取值选择输入：当 \( y_n = 1 \) 时选 \( |x| \)，当 \( y_n = 0 \) 时选 \( 0 \)，从而实现每一步乘法中部分积的加法操作，支持原码一位乘的逻辑。  

（3）  
- 运算开始：\( R_0 \) 存放初始部分积 \( 0 \)；\( R_1 \) 存放乘数 \( y \)。  
- 运算结束：\( R_0 \) 存放乘积的高位部分，\( R_1 \) 存放乘积的低位部分，二者组合为完整的乘积 \( |x| \times |y| \)。  

（4）设第 \( i \) 步部分积为 \( P_i \)，则第 \( i + 1 \) 步部分积为：  
\[  
P_{i+1} = \frac{1}{2} \left( P_i + y_{n - i} |x| \right)
\]  
初始时 \( P_0 = 0 \)，经 \( n \) 次运算后，最终 \( P_n \) 与 \( R_1 \) 中的值共同构成乘积 \( |x| \times |y| \)。  

（5） 
- ① 
  - 作用：\( C_{in} \) 是加法器的进位输入，用于补码乘法中的加减操作。
  - 关系其值由 \( y_n \overline{y_{n+1}} \) 决定，即 \( C_{in} = y_n \overline{y_{n+1}} \)，为加法器提供进位信号，确保补码运算的正确性（如实现 \( +[x]_补 \) 或 \( -[x]_补 \) 的操作）。  
- ② ：  
  - 图 1 中原码一位乘采用逻辑右移，\( C_{out} \) 参与移位是为了保持部分积逻辑扩展的一致性（逻辑右移无符号扩展问题）。- 图 2 中补码一位乘采用算术右移，符号位需保持不变，移位由专门的逻辑处理（确保符号位不变），无需 \( C_{out} \) 参与维持符号，因此 \( C_{out} \) 不参与移位。   

### 4.虚拟存储器访问操作流程如图 3所示，结合图 3，请回答下述问题：

（1）
- TLB 命中：CPU 给出虚拟地址后，首先在快表（TLB）中查找对应的页表项。若找到，直接获取物理页号（PPN），无需访问主存页表，称为 TLB 命中。
-    cache 命中：通过地址转换得到物理地址后，在高速缓存（cache）中查找对应数据块。若数据块存在于 cache 中，可直接读取数据，称为 cache 命中。
-   页命中：虚拟地址对应的页表项存在于主存页表中，即该页面已调入主存，未发生缺页，称为页命中。此时可通过页表项获取物理页号，继续后续操作。
（2）
- 当 TLB 不命中时，需要访问主存页表。因为 TLB 中未找到虚拟地址对应的页表项，必须查询主存页表，判断该页面是否在主存。若页命中，再将页表项更新到 TLB 中，以便后续快速访问。
（3）
- 存在这种情况。TLB 缺失仅表示快表中未缓存对应页表项，但主存页表中该页表项可能存在（页命中），说明页面已在主存。此时，通过物理地址访问 cache 时，若对应数据块已被加载到 cache 中（cache 命中），即可直接从 cache 读取数据。例如，TLB 容量较小，某页表项被淘汰（TLB 缺失），但页面仍在主存（页命中），且数据块已存入 cache（cache 命中）。
（4）
- 相同点：都需要从下一级存储层次加载数据到当前级（缺页时从磁盘加载页面到主存，cache 缺失时从主存加载数据块到 cache）。
- 不同点：缺页处理涉及磁盘 I/O，开销大；cache 缺失处理仅涉及主存到 cache 的数据传输，速度较快。
缺页处理可能需要更新页表和 TLB；cache 缺失处理主要是更新 cache 内容，不涉及页表等结构的修改。

### 6. 设 8位有效信息为 0111 0110，试写出它的海明校验码。如果接收方收到的有效信息变成 0111 1110，说明如何定位错误并纠错。

（1）
设有效信息位 \( n = 8 \)，校验位 \( k = 4 \)（满足 \( 2^k \geq n + k + 1 \)）。校验位 \( P_1, P_2, P_4, P_8 \) 分别位于第 \( 1, 2, 4, 8 \) 位。  
- \( P_1 \) 校验位 \( 1, 3, 5, 7, 9, 11 \)：\( 0 \oplus 1 \oplus 1 \oplus 1 \oplus 0 \oplus 1 = 1 \)。  
- \( P_2 \) 校验位 \( 2, 3, 6, 7, 10, 11 \)：\( 0 \oplus 0 \oplus 1 \oplus 1 \oplus 1 \oplus 1 = 0 \)。  
- \( P_4 \) 校验位 \( 4, 5, 6, 7, 12 \)：\( 1 \oplus 1 \oplus 1 \oplus 1 \oplus 0 = 1 \)。  
- \( P_8 \) 校验位 \( 8, 9, 10, 11, 12 \)：\( 0 \oplus 0 \oplus 1 \oplus 1 \oplus 0 = 0 \)。  

则海明校验码为：\( 1 \, 0 \, 0 \, 1 \, 1 \, 1 \, 1 \, 0 \, 0 \, 1 \, 1 \, 0 \)

（2）
接收方收到有效信息为 \( 0111 \, 1110 \)，重新计算校验和：  
- \( S_1 = P_1 \oplus D_3 \oplus D_5 \oplus D_7 \oplus D_9 \oplus D_{11} = 1 \oplus 0 \oplus 1 \oplus 1 \oplus 1 \oplus 1 = 1 \)。  
- \( S_2 = P_2 \oplus D_3 \oplus D_6 \oplus D_7 \oplus D_{10} \oplus D_{11} = 0 \oplus 0 \oplus 1 \oplus 1 \oplus 1 \oplus 1 = 0 \)。  
- \( S_4 = P_4 \oplus D_5 \oplus D_6 \oplus D_7 \oplus D_{12} = 1 \oplus 1 \oplus 1 \oplus 1 \oplus 0 = 0 \)。  
- \( S_8 = P_8 \oplus D_9 \oplus D_{10} \oplus D_{11} \oplus D_{12} = 0 \oplus 1 \oplus 1 \oplus 1 \oplus 0 = 1 \)。  

将 \( S_8 S_4 S_2 S_1 \) 组合为 \( 1001 \)（十进制 \( 9 \)），表示第 \( 9 \) 位出错。将第 \( 9 \) 位取反，纠错后有效信息为 \( 0111 \, 0110 \)。  
