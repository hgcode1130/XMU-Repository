
现在后端和数据库的蓝图已经清晰，接下来我为您量身打造一份详细的前端设计文档。这份文档将具体到每个页面的风格、布局、使用的组件库（我们将采用强大且主流的 **Element Plus for Vue 3**），以及每个功能点如何与我们之前定义好的 API 进行交互。

## **个人课表系统 - 前端详细设计文档 (第一阶段)**

### **1. 前端技术栈与设计理念**

* **框架**: `Vue 3` (采用 `Vite` 作为构建工具，以获得极速的开发体验)
* **UI 组件库**: `Element Plus` (一套功能强大、风格统一的企业级组件库)
* **状态管理**: `Pinia` (Vue 3 官方推荐的下一代状态管理工具，轻量且直观)
* **HTTP 请求库**: `Axios` (封装统一的请求/响应拦截器，处理 JWT 和错误)
* **路由**: `Vue Router`

**设计理念与风格:**

* **整体风格**: 现代、简洁、专业。界面布局清晰，留白充足，避免信息过载。
* **色彩方案**:

  * **主色调 (Primary)**: `#409EFF` (Element Plus 默认蓝)。用于主要操作按钮、导航高亮、链接等，给人以专业和信任感。
  * **成功色 (Success)**: `#67C23A`。用于成功提示、完成状态。
  * **警告色 (Warning)**: `#E6A23C`。用于提醒、需要用户确认的操作。
  * **危险色 (Danger)**: `#F56C6C`。用于删除操作、错误提示。
  * **信息色 (Info)**: `#909399`。用于辅助性文字、次要信息。
  * **背景色**: `#F5F7FA` (淡灰色)，提供柔和的视觉背景，突出主要内容区域。
* **布局**: 采用经典的后台管理系统布局，即“**顶部-侧边栏-内容区**”结构，提供稳定且符合用户习惯的操作体验。

### **2. 整体布局与全局组件**

#### **2.1 主布局 (Layout)**

这是用户登录后看到的主框架，所有功能页面都在此框架内展示。

* **`<el-container>`**:

  * **`<el-header>` (顶部)**:

    * **左侧**: 显示系统Logo和名称 "个人课表系统"。
    * **右侧**: `el-dropdown` 组件，显示当前用户名。下拉菜单中包含 "退出登录" 选项。
  * **`<el-container>` (侧边栏 + 内容区)**:

    * **`<el-aside>` (侧边栏)**:

      * **学期选择器**: 位于侧边栏顶部，使用 `el-select` 组件。

        * **功能**: 列出当前用户的所有学期 (`GET /api/terms`)。用户切换学期后，将选中的 `termId` 存入 Pinia，并触发课表视图重新获取数据。这是全局数据联动的核心。
        * **API**: `GET /api/terms`
      * **导航菜单 (`el-menu`)**:

        * `课表视图` (指向 `/timetable`)
        * `学期管理` (指向 `/terms`)
    * **`<el-main>` (主内容区)**:

      * 使用 `<router-view>` 来动态展示 `课表视图`、`学期管理` 等页面。
      * 背景色为 `#F5F7FA`。

### **3. 页面详细设计**

#### **3.1 登录与注册页面**

* **布局**: 页面垂直居中，一个宽度约为 400px 的卡片 `el-card`，包含标题和表单。
* **背景**: 可以使用简约的几何图形或柔和的渐变背景，提升美感。

##### **3.1.1 登录页 (`/login`)**

* **组件**: `el-card`, `el-form`, `el-form-item`, `el-input`, `el-button`。
* **功能**:

  1. 表单包含 "用户名" 和 "密码" 两个输入框 (`el-input`, 密码框类型为 `password`)。
  2. 提供表单校验规则 (用户名和密码不能为空)。
  3. 点击 "登录" 按钮 (`el-button`, type="primary")，触发表单校验。
  4. 校验通过后，调用登录 API。

     * **API**: `POST /api/auth/login`
     * **请求体**: `{ "username": "...", "password": "..." }`
  5. 登录成功后，将返回的 `token` 和用户信息存入 `localStorage` 和 `Pinia`，然后跳转到主页 (`/timetable`)。
  6. 登录失败，使用 `ElMessage` 组件显示错误信息 (如: "用户名或密码错误")。
  7. 提供一个链接 "没有账号？立即注册"，跳转到注册页。

##### **3.1.2 注册页 (`/register`)**

* **组件**: `el-card`, `el-form`, `el-form-item`, `el-input`, `el-button`。
* **功能**:

  1. 表单包含 "用户名"、"邮箱"、"密码"、"确认密码" 四个输入框。
  2. 提供完善的表单校验规则 (格式、密码一致性等)。
  3. 点击 "注册" 按钮，调用注册 API。

     * **API**: `POST /api/auth/register`
     * **请求体**: `{ "username": "...", "password": "...", "email": "..." }`
  4. 注册成功后，使用 `ElMessage` 提示 "注册成功！"，并自动跳转到登录页。
  5. 注册失败，显示 API 返回的错误信息 (如: "用户名已存在")。

#### **3.2 课表视图页 (`/timetable`)**

这是系统的核心页面，需要精心设计。

* **布局**:

  * **顶部操作栏**:

    * **视图切换**: `el-radio-group` 或 `el-tabs` 组件，提供 "周视图" 和 "学期视图" 两种模式。
    * **操作按钮**:

      * `el-button` (type="primary"): "手动添加课程"。
      * `el-button` (type="success"): "Excel导入课程"。
  * **内容区**: 根据视图切换动态展示。

##### **3.2.1 周视图 (Week View)**

* **设计**:

  * 使用 `CSS Grid` 或 `Flexbox` 构建一个 `7列 * N行` 的网格。列代表周一到周日，行代表节次 (如 1-12 节)。
  * 网格的每个单元格 (`cell`) 代表一个时间片。
  * 课程卡片 (`course-item`) 会根据其 `dayOfWeek`, `startPeriod`, `endPeriod` 被动态地放置在网格中。一个课程卡片的高度会根据 `endPeriod - startPeriod + 1` 动态拉伸，占据多个单元格。
  * 课程卡片内显示：`课程名称`, `@上课地点`。使用不同颜色区分不同课程，增加可读性。
* **组件**: `el-card`, `el-dialog`, `el-form` 等。
* **功能与 API**:

  1. **数据加载**: 页面加载或切换学期时，获取当前学期的所有课程。

     * **API**: `GET /api/terms/{termId}/courses` (termId 从 Pinia 中获取)。
     * 获取数据后，通过计算属性或方法将课程列表转换为适合网格布局的数据结构。
  2. **查看课程详情**: 鼠标悬浮 (`hover`) 在课程卡片上时，使用 `el-tooltip` 或 `el-popover` 显示完整的课程信息 (教师、周次、备注等)。
  3. **编辑/删除课程**: 点击课程卡片，弹出一个 `el-dialog` (对话框)。

     * 对话框内显示课程的完整信息，并提供 "编辑" 和 "删除" 按钮。
     * "编辑" 功能详见 **3.2.3 课程操作对话框**。
     * "删除" 则弹出 `el-message-box` 确认框，确认后调用删除 API。

       * **API**: `DELETE /api/courses/{courseId}`
       * 成功后从前端移除该课程卡片，并提示 "删除成功"。
  4. **快速添加课程**: 点击网格中的空白单元格，也可以弹出一个预填了 `星期` 和 `节次` 的 "添加课程" 对话框。

##### **3.2.2 学期视图 (Term View)**

* **设计**: 当课程排期不规律，或者用户想查看学期内所有课程列表时使用。
* **组件**: `el-table`。
* **功能与 API**:

  1. 使用 `el-table` 以表格形式展示课程。
  2. **表格列 (el-table-column)**: 课程名称、任课教师、备注、操作。
  3. **展开行**: 使用 `type="expand"` 的列，点击展开后，显示该课程下所有的排程信息 (`schedule_entries`)，包括地点、周次、星期、节次。这非常适合展示一对多的复杂结构。
  4. **操作列**: 包含 "编辑" 和 "删除" 按钮，其功能与周视图中点击课程卡片后的操作相同。
  5. **数据源**: 与周视图共享，同样来自 `GET /api/terms/{termId}/courses`。

##### **3.2.3 课程操作对话框 (添加/编辑)**

这是一个可复用的组件，通过 `mode` (add/edit) 区分是添加还是编辑。

* **组件**: `el-dialog`, `el-form`, `el-input`, `el-select`, `el-input-number`。
* **表单字段**:

  * 课程名称 (`el-input`)
  * 任课教师 (`el-input`, 提示多个教师用逗号分隔)
  * 课程备注 (`el-input`, type="textarea")
  * **排程列表 (核心)**:

    * 这是一个动态表单，用户可以动态添加/删除条目。
    * 每一条排程信息包含：上课地点 (`el-input`)、星期 (`el-select` 1-7)、开始周/结束周 (`el-input-number`)、开始节/结束节 (`el-input-number`)。
* **功能与 API**:

  1. **添加模式**:

     * 表单为空，用户填写所有信息。
     * 点击 "确定"，调用添加 API。
     * **API**: `POST /api/courses`
     * **请求体**: 组装文档中定义的 JSON 结构。
     * 成功后关闭弹窗，刷新课表视图，并提示 "添加成功"。
  2. **编辑模式**:

     * 打开对话框时，表单内已填充所点击课程的现有数据。
     * 点击 "确定"，调用更新 API。
     * **API**: `PUT /api/courses/{courseId}`
     * **请求体**: 同样组装完整的课程 JSON 结构。
     * 成功后关闭弹窗，刷新课表视图，并提示 "更新成功"。

##### **3.2.4 Excel 导入对话框**

* **组件**: `el-dialog`, `el-upload`。
* **功能与 API**:

  1. 点击 "Excel导入课程" 按钮，打开一个 `el-dialog`。
  2. 对话框内有一个 `el-upload` 组件，用于上传文件。
  3. 提供一个 "下载模板" 的链接，方便用户了解格式。
  4. 用户选择文件并上传，前端将文件 `POST` 到指定接口。

     * **API**: `POST /api/import/excel?termId={termId}`
  5. 接口返回成功或失败的信息，前端通过 `ElNotification` 或 `ElMessage` 将导入结果 (成功几条、失败几条、错误原因) 展示给用户。
  6. 导入成功后，刷新课表视图。

#### **3.3 学期管理页 (`/terms`)**

* **布局**: 一个 `el-card`，上方是 "新建学期" 按钮，下方是学期列表。
* **组件**: `el-table`, `el-button`, `el-dialog`, `el-form`, `el-date-picker`。
* **功能与 API**:

  1. **显示列表**: 使用 `el-table` 展示所有学期。列包括：学期名称、开始日期、结束日期、操作。

     * **API**: `GET /api/terms`
  2. **新建学期**:

     * 点击 "新建学期" 按钮，弹出 `el-dialog`。
     * 对话框中是一个表单，包含 "学期名称" (`el-input`)、"起止日期" (`el-date-picker`, type="daterange")。
     * 点击 "确定" 调用新建 API。
     * **API**: `POST /api/terms`
     * 成功后刷新学期列表和侧边栏的学期选择器。
  3. **编辑学期**:

     * 点击操作列的 "编辑" 按钮，弹出与新建类似的对话框，并填充好数据。
     * 点击 "确定" 调用更新 API。
     * **API**: `PUT /api/terms/{termId}`
  4. **删除学期**:

     * 点击 "删除" 按钮，弹出 `el-message-box` 确认框（**重要提示**: "删除学期将同时删除该学期下的所有课程，是否继续？"）。
     * 用户确认后，调用删除 API。
     * **API**: `DELETE /api/terms/{termId}`
     * 成功后刷新学期列表和侧边栏的学期选择器。
